<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="video-text.css" />
    <link rel="icon" href="image/favicon.png" type="image/png" sizes="32x32" />
    <title>Vidéo dans le Texte - Chrystelle Albina</title>
  </head>

  <body>
    <div class="container">
      <a
        id="event"
        href="https://projetevenement.netlify.app/"
        target="_blank"
        class="button-link"
        >Evenement & Co</a
      >

      <a
        id="ink"
        href="https://inkpulse.netlify.app/"
        target="_blank"
        class="button-link"
        >Ink Pulse</a
      >
      <a id="devine" href="" target="_blank" class="button-link"
        >devine le nombre</a
      >
    </div>

    <div class="link">
      <h2 id="name">Chrystelle Albina</h2>

      <a href="index.html"><img src="/image/accueil.webp" alt="" /></a>
      <a href="https://github.com/ChrystelleALBINA" target="_blank"
        ><img src="/image/github.png" alt="logo cliquable github"
      /></a>
      <a
        href="https://www.linkedin.com/in/chrystelle-albina-8509a944/"
        target="_blank"
        ><img src="/image/linkedin .png" alt="logo cliquable linkedin"
      /></a>
    </div>

    <footer>
      <p>&copy; 2025 Portfolio Chrystelle Albina. All rights reserved.</p>
    </footer>

    <!-- Vidéo cachée pour l'arrière-plan -->
    <video id="backgroundVideo" style="display: none" autoplay muted loop>
      <source
        src="https://cdn.coverr.co/videos/coverr-waves-crashing-on-the-shore-694/1080p.mp4"
        type="video/mp4"
      />
    </video>

    <canvas id="videoCanvas" style="display: none"></canvas>
  </body>

  <script>
    // Fonction pour capturer la vidéo et l'appliquer comme arrière-plan du texte
    function setupVideoBackground() {
      const video = document.getElementById("backgroundVideo");
      const canvas = document.getElementById("videoCanvas");
      const ctx = canvas.getContext("2d");
      const nameElement = document.getElementById("name");

      // Fonction de secours si la vidéo ne charge pas
      function fallbackAnimation() {
        console.log("Utilisation de l'animation de secours");
        nameElement.style.backgroundImage =
          "linear-gradient(45deg, #667eea, #764ba2, #f093fb, #f5576c)";
        nameElement.style.backgroundSize = "400% 400%";
        nameElement.style.animation = "gradientShift 3s ease infinite";
      }

      // Attendre que la vidéo soit chargée
      video.addEventListener("loadeddata", function () {
        console.log("Vidéo chargée avec succès");
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        function drawVideo() {
          if (video.readyState === video.HAVE_ENOUGH_DATA) {
            try {
              ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

              // Convertir le canvas en URL pour l'arrière-plan
              const imageUrl = canvas.toDataURL("image/jpeg", 0.8);

              // Appliquer l'image comme arrière-plan du texte
              nameElement.style.backgroundImage = `url(${imageUrl})`;
              nameElement.style.backgroundSize = "cover";
              nameElement.style.backgroundPosition = "center";
              nameElement.style.backgroundClip = "text";
              nameElement.style.webkitBackgroundClip = "text";
              nameElement.style.color = "transparent";
            } catch (error) {
              console.error("Erreur lors du traitement de la vidéo:", error);
              fallbackAnimation();
            }
          }

          requestAnimationFrame(drawVideo);
        }

        drawVideo();
      });

      // Gestion des erreurs de la vidéo
      video.addEventListener("error", function (e) {
        console.error("Erreur de chargement de la vidéo:", e);
        fallbackAnimation();
      });

      // Timeout pour détecter si la vidéo ne charge pas
      setTimeout(() => {
        if (video.readyState < 2) {
          console.log("Vidéo non chargée, utilisation du fallback");
          fallbackAnimation();
        }
      }, 5000);

      // Démarrer la vidéo
      video.play().catch((error) => {
        console.error("Impossible de lire la vidéo:", error);
        fallbackAnimation();
      });
    }

    // Initialiser quand la page est chargée
    window.addEventListener("load", setupVideoBackground);
  </script>
</html>
